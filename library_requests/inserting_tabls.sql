CREATE TABLE books (
	cipher varchar NOT NULL,
	author varchar NULL,
	genre varchar NULL,
	"year" int4 NULL,
	publishing_house varchar NULL,
	description text NULL,
	is_available bool NULL,
	CONSTRAINT books_pkey PRIMARY KEY (cipher)
);

CREATE TABLE readers (
	id int4 NOT NULL,
	surname varchar NULL,
	"name" varchar NULL,
	date_of_birth date NULL,
	address varchar NULL,
	CONSTRAINT readers_pkey PRIMARY KEY (id)
);

CREATE table lending_books (
	cipher varchar NULL,
	issue_date date NULL,
	return_date date NULL,
	reader_id int4 NULL,
	CONSTRAINT lending_books_cipher_fkey FOREIGN KEY (cipher) REFERENCES books(cipher),
	CONSTRAINT lending_books_reader_id_fkey FOREIGN KEY (reader_id) REFERENCES readers(id)
);

INSERT INTO readers (id, surname, name, date_of_birth, address)
VALUES
(3, 'Семенюк', 'Виктор', '1981-10-17','ул. Северная, 31'),
(4, 'Яременко', 'Егор', '1943-2-24','ул. Парковая, 170'),
(5, 'Ткачук', 'Иван', '1992-11-16','ул. Первомайская, 93'),
(6, 'Костюк', 'Константин', '2003-6-3','ул. Парковая, 122'),
(7, 'Сердюк', 'Олег', '1931-12-14','ул. Речная, 78'),
(8, 'Ткачук', 'Роман', '1954-11-27','ул. Школьная, 148'),
(9, 'Ткачук', 'Кирилл', '1991-8-13','ул. Речная, 21'),
(10, 'Кравченко', 'Георгий', '1967-7-25','ул. Калинина, 158'),
(11, 'Гордиенко', 'Михаил', '1955-10-25','ул. Луговая, 17'),
(12, 'Гордиенко', 'Татьяна', '1978-7-13','ул. Южная, 178'),
(13, 'Ткачук', 'Екатерина', '1954-3-11','ул. Западная, 26'),
(14, 'Демчук', 'Вероника', '1986-7-5','ул. Кирова, 66'),
(15, 'Бондаренко', 'Мария', '1956-5-9','ул. Комсомольская, 18'),
(16, 'Рябчук', 'Сергей', '1958-4-7','ул. Южная, 183'),
(17, 'Горбатюк', 'Маргарита', '2008-5-24','ул. Калинина, 109'),
(18, 'Бондаренко', 'Алина', '1957-3-4','ул. Гагарина, 15'),
(19, 'Мельник', 'Дарья', '1996-12-3','ул. Победы, 194'),
(20, 'Панасюк', 'Мария', '1966-4-14','ул. Восточная, 186'),
(21, 'Романюк', 'Ирина', '1938-5-11','ул. Ленина, 180'),
(22, 'Ткачук', 'Федор', '1985-2-19','ул. Заводская, 119'),
(23, 'Сидорчук', 'Егор', '1927-1-24','ул. Мира, 84'),
(24, 'Рябчук', 'Роман', '1951-2-25','ул. Первомайская, 189'),
(25, 'Шевчук', 'Наталья', '1944-3-28','ул. Цветочная, 15'),
(26, 'Лисенко', 'Павел', '1963-2-22','ул. Мира, 62'),
(27, 'Лисенко', 'Маргарита', '1978-5-10','ул. Карла Маркса, 142'),
(28, 'Сердюк', 'Ирина', '1970-9-9','ул. Полевая, 87'),
(29, 'Сердюк', 'Максим', '1990-1-19','ул. Полевая, 179'),
(30, 'Ковтун', 'Максим', '1944-12-13','ул. Южная, 140'),
(31, 'Дьячук', 'Юлия', '2009-8-1','ул. Солнечная, 165'),
(32, 'Шаповал', 'Юлия', '1923-4-21','ул. Пушкина, 128'),
(33, 'Ткачук', 'Егор', '1948-10-6','ул. Парковая, 122'),
(34, 'Дорошенко', 'Алиса', '1977-2-27','ул. Зелёная, 74'),
(35, 'Семенюк', 'Артем', '1974-2-25','ул. Северная, 5'),
(36, 'Зозуля', 'Анна', '1963-12-15','ул. Парковая, 29'),
(37, 'Бондарчук', 'Анна', '1942-11-25','ул. Берёзовая, 74'),
(38, 'Шаповал', 'Кирилл', '1945-6-11','ул. Молодежная, 20'),
(39, 'Бондаренко', 'Татьяна', '1946-12-19','ул. Полевая, 145'),
(40, 'Мельниченко', 'Владимир', '1991-4-26','ул. Ленина, 197'),
(41, 'Семенчук', 'Георгий', '1986-7-21','ул. Горького, 20'),
(42, 'Демчук', 'Анна', '1988-3-25','ул. Строителей, 47'),
(43, 'Горбатюк', 'Елена', '1948-4-5','ул. Спортивная, 56'),
(44, 'Левченко', 'Наталья', '1921-4-16','ул. Горького, 187'),
(45, 'Петренко', 'Елена', '2007-10-3','ул. Южная, 24'),
(46, 'Панасюк', 'Карина', '1929-1-19','ул. Чапаева, 180'),
(47, 'Дорошенко', 'София', '2002-11-18','ул. Новая, 125'),
(48, 'Петренко', 'Виктор', '1984-12-17','ул. Мира, 21'),
(49, 'Шевчук', 'Сергей', '1966-10-5','ул. Октябрьская, 117'),
(50, 'Онищенко', 'Павел', '1931-7-21','ул. Набережная, 95'),
(51, 'Лисенко', 'Максим', '1973-4-25','ул. Гагарина, 111'),
(52, 'Шаповал', 'Дмитрий', '1962-10-14','ул. Чапаева, 72'),
(53, 'Онищенко', 'Михаил', '1947-12-20','ул. Колхозная, 165'),
(54, 'Шаповал', 'Маргарита', '1986-7-27','ул. Чапаева, 55'),
(55, 'Панасюк', 'Максим', '1984-2-11','ул. Октябрьская, 26'),
(56, 'Савченко', 'Олег', '1945-11-28','ул. Рабочая, 67'),
(57, 'Лисенко', 'Алиса', '1925-8-17','ул. Берёзовая, 146'),
(58, 'Петрик', 'Дарья', '1924-4-25','ул. Западная, 138'),
(59, 'Бондаренко', 'Владимир', '1934-3-22','ул. Дружбы, 100'),
(60, 'Панасюк', 'Елена', '2008-7-16','ул. Парковая, 62'),
(61, 'Горбатюк', 'Кирилл', '1948-3-22','ул. Мира, 85'),
(62, 'Мельник', 'Дмитрий', '1975-6-17','ул. Комсомольская, 4'),
(63, 'Мельниченко', 'София', '1955-10-7','ул. Колхозная, 134'),
(64, 'Ткачук', 'Степан', '2001-2-23','ул. Парковая, 5'),
(65, 'Лисенко', 'Михаил', '1950-12-12','ул. Ленина, 30'),
(66, 'Полищук', 'Олег', '2006-5-18','ул. Южная, 152'),
(67, 'Романюк', 'Татьяна', '1958-7-5','ул. Школьная, 57'),
(68, 'Панасюк', 'Михаил', '1943-4-26','ул. Карла Маркса, 20'),
(69, 'Лисенко', 'Максим', '1991-9-21','ул. Восточная, 13'),
(70, 'Тимошенко', 'Евгения', '1983-8-18','ул. Победы, 100'),
(71, 'Ковальчук', 'Роман', '2000-10-28','ул. Зелёная, 194'),
(72, 'Литвиненко', 'Николай', '1960-12-19','ул. Луговая, 199'),
(73, 'Панасюк', 'Владимир', '1925-12-28','ул. Садовая, 122'),
(74, 'Гриценко', 'Анна', '1950-1-7','ул. Берёзовая, 104'),
(75, 'Кузьменко', 'Алексей', '1927-4-27','ул. Солнечная, 138'),
(76, 'Романюк', 'Олег', '1960-3-28','ул. Школьная, 69'),
(77, 'Гордиенко', 'Полина', '1983-6-1','ул. Рабочая, 139'),
(78, 'Захарчук', 'Полина', '1930-1-20','ул. Молодежная, 21'),
(79, 'Демчук', 'Николай', '1967-7-22','ул. Молодежная, 183'),
(80, 'Сидорчук', 'Андрей', '1976-1-3','ул. Луговая, 63'),
(81, 'Ковтун', 'Роман', '1977-5-23','ул. Гагарина, 27'),
(82, 'Лисенко', 'Роман', '1976-3-27','ул. Луговая, 105'),
(83, 'Рябчук', 'Лидия', '1989-10-26','ул. Набережная, 160'),
(84, 'Сидорчук', 'Егор', '2002-9-7','ул. Гагарина, 67'),
(85, 'Тимошенко', 'Алина', '1927-4-14','ул. Школьная, 116'),
(86, 'Левченко', 'Маргарита', '2007-4-20','ул. Западная, 37'),
(87, 'Костюк', 'София', '1944-4-23','ул. Дружбы, 33'),
(88, 'Зозуля', 'Анна', '1998-3-10','ул. Парковая, 12'),
(89, 'Тимошенко', 'Лидия', '1986-11-4','ул. Строителей, 26'),
(90, 'Яременко', 'Ксения', '1972-9-27','ул. Карла Маркса, 2'),
(91, 'Кравченко', 'Лидия', '1950-6-17','ул. Победы, 54'),
(92, 'Шевченко', 'Иван', '1992-9-13','ул. Октябрьская, 10'),
(93, 'Бондарчук', 'Роман', '2009-11-3','ул. Колхозная, 135'),
(94, 'Литвиненко', 'Юлия', '1979-4-27','ул. Комсомольская, 119'),
(95, 'Ткачук', 'Николай', '1951-3-17','ул. Весенняя, 151'),
(96, 'Марченко', 'София', '1983-3-16','ул. Луговая, 77'),
(97, 'Савченко', 'Егор', '1932-1-11','ул. Весенняя, 34'),
(98, 'Гордиенко', 'Полина', '1967-9-17','ул. Рабочая, 71'),
(99, 'Ковтун', 'Екатерина', '1978-10-27','ул. Центральная, 16'),
(100, 'Яременко', 'Алина', '1984-3-1','ул. Северная, 136');

INSERT INTO readers (id, surname, name, date_of_birth, address)
VALUES
(101, 'Рябчук', 'Виктор', '2010-9-4','ул. Восточная, 57'),
(102, 'Савченко', 'Анна', '1989-12-15','ул. Западная, 32'),
(103, 'Дьячук', 'Анна', '1977-12-21','ул. Кирова, 198'),
(104, 'Марченко', 'Юлия', '1943-11-18','ул. Спортивная, 84'),
(105, 'Семенчук', 'Лидия', '1986-2-11','ул. Молодежная, 61'),
(106, 'Ковальчук', 'Ольга', '1945-1-5','ул. Калинина, 161'),
(107, 'Горбатюк', 'Константин', '1959-5-14','ул. Речная, 131'),
(108, 'Панасюк', 'Карина', '1943-4-21','ул. Набережная, 29'),
(109, 'Рябчук', 'Михаил', '1929-5-6','ул. Северная, 143'),
(110, 'Марченко', 'Евгения', '1932-3-16','ул. Калинина, 169'),
(111, 'Рябчук', 'Татьяна', '1993-1-13','ул. Первомайская, 153'),
(112, 'Сердюк', 'Дарья', '1981-5-10','ул. Дружбы, 37'),
(113, 'Петрик', 'Ксения', '1988-4-22','ул. Кирова, 77'),
(114, 'Дорошенко', 'Иван', '1978-1-4','ул. Центральная, 147'),
(115, 'Семенюк', 'Кирилл', '1942-10-8','ул. Карла Маркса, 124'),
(116, 'Бондаренко', 'Алиса', '2010-12-20','ул. Гагарина, 42'),
(117, 'Сидорчук', 'Полина', '1931-1-6','ул. Гагарина, 122'),
(118, 'Онищенко', 'Георгий', '2005-8-3','ул. Восточная, 64'),
(119, 'Шаповал', 'Вероника', '2010-7-11','ул. Мира, 24'),
(120, 'Панасюк', 'Олег', '1958-6-9','ул. Чапаева, 146'),
(121, 'Гриценко', 'Кирилл', '1950-6-4','ул. Заводская, 198'),
(122, 'Полищук', 'Федор', '1954-10-6','ул. Советская, 124'),
(123, 'Шаповал', 'Евгения', '1968-10-4','ул. Северная, 98'),
(124, 'Кравченко', 'Андрей', '1974-6-28','ул. Южная, 102'),
(125, 'Ковальчук', 'Татьяна', '1995-4-17','ул. Цветочная, 188'),
(126, 'Яременко', 'Ксения', '2005-5-18','ул. Берёзовая, 177'),
(127, 'Сидорчук', 'Георгий', '1953-1-13','ул. Цветочная, 39'),
(128, 'Тимошенко', 'Андрей', '1926-8-23','ул. Цветочная, 30'),
(129, 'Гаврилюк', 'Виктор', '1962-7-22','ул. Школьная, 151'),
(130, 'Горбатюк', 'Анна', '1946-1-4','ул. Мира, 124'),
(131, 'Полищук', 'Алиса', '1968-5-26','ул. Весенняя, 58'),
(132, 'Дорошенко', 'Наталья', '1982-4-18','ул. Ленина, 36'),
(133, 'Романюк', 'Дмитрий', '1949-3-16','ул. Берёзовая, 57'),
(134, 'Горбатюк', 'Евгения', '1992-9-10','ул. Калинина, 27'),
(135, 'Киричук', 'Алина', '1986-6-1','ул. Полевая, 166'),
(136, 'Семенюк', 'Полина', '1952-7-8','ул. Полевая, 166'),
(137, 'Тимошенко', 'Юлия', '1935-7-10','ул. Ленина, 22'),
(138, 'Ткачук', 'Иван', '1996-2-6','ул. Набережная, 61'),
(139, 'Онищенко', 'Степан', '1966-9-16','ул. Чапаева, 2'),
(140, 'Шаповал', 'Олег', '1964-11-12','ул. Калинина, 88'),
(141, 'Костюк', 'Карина', '1931-6-18','ул. Школьная, 49'),
(142, 'Марченко', 'Степан', '1928-8-12','ул. Калинина, 195'),
(143, 'Горбатюк', 'Федор', '1997-9-21','ул. Карла Маркса, 42'),
(144, 'Зозуля', 'Михаил', '1987-2-15','ул. Молодежная, 134'),
(145, 'Бондаренко', 'Маргарита', '1923-5-20','ул. Молодежная, 157'),
(146, 'Гаврилюк', 'Маргарита', '1988-2-10','ул. Западная, 185'),
(147, 'Романюк', 'Юлия', '1959-5-14','ул. Пушкина, 90'),
(148, 'Петрик', 'Степан', '1967-7-13','ул. Речная, 20'),
(149, 'Панасюк', 'Ксения', '1961-7-21','ул. Цветочная, 196'),
(150, 'Гриценко', 'Дмитрий', '1964-3-13','ул. Южная, 121'),
(151, 'Рябчук', 'Ксения', '1933-11-6','ул. Ленина, 108'),
(152, 'Ткачук', 'Артем', '1937-3-12','ул. Мира, 142'),
(153, 'Кузьменко', 'София', '1920-3-7','ул. Мира, 141');

INSERT INTO books (cipher, author, genre, year, publishing_house, description)
VALUES
('M7902697', 'Чингиз Айтматов', 'Фантастика', 1954, 'Наука', 'Это книга'),
('A7271521', 'Евгений Замятин', 'Приключения', 1823, 'Лабиринт', 'Это книга'),
('M1306424', 'Валентин Распутин', 'Поэзия', 1902, 'Росмэн', 'Это книга'),
('T8828189', 'Федор Достоевский', 'Роман', 1962, 'Питер', 'Это книга'),
('A0497511', 'Дина Рубина', 'Приключения', 1954, 'Азбука', 'Это книга'),
('J1947121', 'Константин Паустовский', 'Поэзия', 1853, 'Эксмо', 'Это книга'),
('V9808640', 'Константин Паустовский', 'Мистика', 1901, 'Махаон', 'Это книга'),
('X7903774', 'Илья Ильф', 'Фантастика', 1950, 'АСТ', 'Это книга'),
('M7321264', 'Федор Достоевский', 'Приключения', 1856, 'Махаон', 'Это книга'),
('E0342665', 'Григорий Данилевский', 'Драма', 1728, 'Росмэн', 'Это книга'),
('O9150853', 'Федор Достоевский', 'Фэнтези', 1994, 'Азбука', 'Это книга'),
('T1750139', 'Алексей Толстой', 'Мистика', 1864, 'Питер', 'Это книга'),
('D2035454', 'Александр Куприн', 'Научная литература', 1937, 'Просвещение', 'Это книга'),
('W8766454', 'Алексей Толстой', 'Роман', 1719, 'АСТ', 'Это книга'),
('R9406192', 'Сергей Лукьяненко', 'Драма', 1825, 'Эксмо', 'Это книга'),
('B8483510', 'Алексей Толстой', 'Драма', 1859, 'Махаон', 'Это книга'),
('X9726712', 'Иван Тургенев', 'Научная литература', 1975, 'Лабиринт', 'Это книга'),
('E6180754', 'Федор Достоевский', 'Мистика', 1852, 'АСТ', 'Это книга'),
('B5645835', 'Дмитрий Глуховский', 'Роман', 1765, 'Эксмо', 'Это книга'),
('S6901503', 'Лев Толстой', 'Роман', 1725, 'Эксмо', 'Это книга'),
('Z2164792', 'Чингиз Айтматов', 'Фэнтези', 1748, 'Азбука', 'Это книга'),
('L1853038', 'Владимир Набоков', 'Роман', 1705, 'Просвещение', 'Это книга'),
('U6533368', 'Валентин Распутин', 'Детектив', 1897, 'Альпина Паблишер', 'Это книга'),
('I3808111', 'Валентин Распутин', 'История', 1913, 'Эксмо', 'Это книга'),
('H1708711', 'Виктор Пелевин', 'Поэзия', 1912, 'Росмэн', 'Это книга'),
('Y9150592', 'Дина Рубина', 'Драма', 1898, 'АСТ', 'Это книга'),
('J7779812', 'Александр Грин', 'Детектив', 1891, 'Махаон', 'Это книга'),
('H3250966', 'Федор Достоевский', 'История', 1955, 'Эксмо', 'Это книга'),
('J2751536', 'Александр Грин', 'Мистика', 1731, 'Просвещение', 'Это книга'),
('Z9648933', 'Валентин Распутин', 'Фэнтези', 1858, 'Эксмо', 'Это книга'),
('O6158284', 'Александр Куприн', 'Драма', 1876, 'Росмэн', 'Это книга'),
('S3319842', 'Дина Рубина', 'Мистика', 1907, 'Альпина Паблишер', 'Это книга'),
('P9903525', 'Аркадий Стругацкий', 'Мистика', 1782, 'Эксмо', 'Это книга'),
('L1471443', 'Михаил Булгаков', 'Приключения', 1888, 'Альпина Паблишер', 'Это книга'),
('U1064875', 'Дина Рубина', 'Приключения', 1805, 'Росмэн', 'Это книга'),
('J2572811', 'Василий Шукшин', 'Детектив', 1883, 'Наука', 'Это книга'),
('Z7274387', 'Лев Толстой', 'Поэзия', 1718, 'Азбука', 'Это книга'),
('S4859233', 'Марина Степнова', 'Детектив', 1898, 'Наука', 'Это книга'),
('X7755282', 'Евгений Замятин', 'Научная литература', 1783, 'Питер', 'Это книга'),
('Y8781821', 'Александр Грин', 'Драма', 1712, 'Питер', 'Это книга'),
('N8484381', 'Илья Ильф', 'Мистика', 1871, 'Наука', 'Это книга'),
('Z0449252', 'Борис Акунин', 'Приключения', 1965, 'АСТ', 'Это книга'),
('V0357857', 'Евгений Замятин', 'Мистика', 1869, 'АСТ', 'Это книга'),
('Z2981620', 'Чингиз Айтматов', 'История', 1765, 'Махаон', 'Это книга'),
('A7635970', 'Борис Стругацкий', 'Драма', 1741, 'Азбука', 'Это книга'),
('F5607612', 'Чингиз Айтматов', 'Приключения', 1924, 'Махаон', 'Это книга'),
('I8512328', 'Аркадий Стругацкий', 'Драма', 1878, 'Лабиринт', 'Это книга'),
('Z1643138', 'Владимир Набоков', 'Научная литература', 1871, 'Росмэн', 'Это книга'),
('M6221413', 'Чингиз Айтматов', 'Фантастика', 1839, 'Лабиринт', 'Это книга'),
('S6753260', 'Григорий Данилевский', 'Приключения', 1809, 'Азбука', 'Это книга'),
('Z3131101', 'Борис Акунин', 'Драма', 1900, 'Питер', 'Это книга'),
('L0903725', 'Андрей Платонов', 'Научная литература', 1964, 'Альпина Паблишер', 'Это книга'),
('B2498167', 'Михаил Булгаков', 'История', 1743, 'Наука', 'Это книга'),
('U1050282', 'Михаил Булгаков', 'Приключения', 1839, 'АСТ', 'Это книга'),
('W4846522', 'Чингиз Айтматов', 'Детектив', 1802, 'Махаон', 'Это книга'),
('L6844282', 'Дина Рубина', 'Фэнтези', 1906, 'Наука', 'Это книга'),
('W2373134', 'Василий Шукшин', 'История', 1786, 'Наука', 'Это книга'),
('I3873005', 'Федор Достоевский', 'Поэзия', 1737, 'Махаон', 'Это книга'),
('C9516671', 'Виктор Астафьев', 'Приключения', 1746, 'Альпина Паблишер', 'Это книга'),
('D6180346', 'Дина Рубина', 'Фэнтези', 1772, 'Лабиринт', 'Это книга'),
('K3037377', 'Виктор Астафьев', 'Поэзия', 1812, 'Альпина Паблишер', 'Это книга'),
('V9725697', 'Константин Паустовский', 'Детектив', 1904, 'Махаон', 'Это книга'),
('S6654804', 'Федор Достоевский', 'Роман', 1833, 'Азбука', 'Это книга'),
('I4751222', 'Григорий Данилевский', 'Фантастика', 1761, 'АСТ', 'Это книга'),
('I2390017', 'Андрей Платонов', 'История', 1883, 'АСТ', 'Это книга'),
('F1092751', 'Федор Достоевский', 'Драма', 1798, 'Махаон', 'Это книга'),
('J3163219', 'Владимир Набоков', 'Научная литература', 1956, 'Лабиринт', 'Это книга'),
('A6978348', 'Валентин Распутин', 'Роман', 1846, 'Наука', 'Это книга'),
('S7324480', 'Александр Куприн', 'Поэзия', 1972, 'АСТ', 'Это книга'),
('A0115351', 'Михаил Булгаков', 'Поэзия', 1942, 'Альпина Паблишер', 'Это книга'),
('G0382507', 'Евгений Замятин', 'Детектив', 1906, 'Альпина Паблишер', 'Это книга'),
('L4949345', 'Андрей Платонов', 'Детектив', 1998, 'Махаон', 'Это книга'),
('I8025687', 'Виктор Пелевин', 'История', 1842, 'Махаон', 'Это книга'),
('L0985792', 'Виктор Астафьев', 'Фантастика', 1985, 'Лабиринт', 'Это книга'),
('T4053234', 'Аркадий Стругацкий', 'Фэнтези', 1904, 'Просвещение', 'Это книга'),
('M6104186', 'Валентин Распутин', 'Поэзия', 1877, 'Просвещение', 'Это книга'),
('Y5386273', 'Андрей Платонов', 'Мистика', 1870, 'АСТ', 'Это книга'),
('I7165710', 'Борис Акунин', 'Мистика', 1927, 'Эксмо', 'Это книга'),
('B6413834', 'Василий Шукшин', 'История', 1893, 'Лабиринт', 'Это книга'),
('W2800087', 'Юрий Бондарев', 'Драма', 1791, 'Наука', 'Это книга'),
('S6970907', 'Аркадий Стругацкий', 'Научная литература', 1799, 'Просвещение', 'Это книга'),
('Z0978766', 'Юрий Бондарев', 'Детектив', 1849, 'Альпина Паблишер', 'Это книга'),
('P6672266', 'Валентин Распутин', 'Научная литература', 1843, 'Эксмо', 'Это книга'),
('F7188080', 'Виктор Пелевин', 'Научная литература', 1987, 'Росмэн', 'Это книга'),
('F7626053', 'Михаил Булгаков', 'Поэзия', 1942, 'Росмэн', 'Это книга'),
('E3807139', 'Борис Акунин', 'Фэнтези', 1701, 'Питер', 'Это книга'),
('F1069692', 'Виктор Астафьев', 'Поэзия', 1759, 'Питер', 'Это книга'),
('G0588331', 'Борис Акунин', 'Научная литература', 1700, 'Эксмо', 'Это книга'),
('L6171936', 'Виктор Пелевин', 'Фэнтези', 1804, 'Наука', 'Это книга'),
('Z8682831', 'Николай Гоголь', 'История', 1731, 'Азбука', 'Это книга'),
('L9328462', 'Виктор Астафьев', 'Фантастика', 1758, 'Питер', 'Это книга'),
('S8739790', 'Александр Грин', 'Приключения', 1810, 'Питер', 'Это книга'),
('B1344913', 'Михаил Булгаков', 'Роман', 1874, 'Росмэн', 'Это книга'),
('W7006182', 'Антон Чехов', 'Фэнтези', 1990, 'Лабиринт', 'Это книга'),
('S6849186', 'Константин Паустовский', 'История', 1812, 'Лабиринт', 'Это книга'),
('V8050871', 'Антон Чехов', 'Поэзия', 1931, 'Питер', 'Это книга'),
('R6592296', 'Аркадий Стругацкий', 'Мистика', 1974, 'Просвещение', 'Это книга'),
('R5039078', 'Сергей Лукьяненко', 'Фэнтези', 1922, 'Азбука', 'Это книга'),
('W4333221', 'Марина Степнова', 'Роман', 1707, 'Питер', 'Это книга'),
('A4832318', 'Александр Куприн', 'Фэнтези', 1932, 'Просвещение', 'Это книга'),
('C3983014', 'Виктор Астафьев', 'Детектив', 1741, 'Эксмо', 'Это книга'),
('H8830890', 'Александр Пушкин', 'Детектив', 1747, 'Питер', 'Это книга'),
('W7356278', 'Лев Толстой', 'Фантастика', 1703, 'Эксмо', 'Это книга'),
('A2826340', 'Евгений Замятин', 'Фантастика', 1976, 'Махаон', 'Это книга'),
('G1216807', 'Михаил Булгаков', 'История', 1973, 'Азбука', 'Это книга'),
('Q3493163', 'Марина Степнова', 'Мистика', 1853, 'Азбука', 'Это книга'),
('U0316569', 'Чингиз Айтматов', 'Фантастика', 1792, 'Махаон', 'Это книга'),
('D8829628', 'Борис Акунин', 'Роман', 1730, 'Эксмо', 'Это книга'),
('Q9624430', 'Чингиз Айтматов', 'Приключения', 1739, 'Просвещение', 'Это книга'),
('H5760836', 'Дмитрий Глуховский', 'Научная литература', 1703, 'АСТ', 'Это книга'),
('P0125955', 'Лев Толстой', 'Мистика', 1775, 'Азбука', 'Это книга'),
('F0721188', 'Аркадий Стругацкий', 'Драма', 1836, 'Азбука', 'Это книга'),
('O5312553', 'Лев Толстой', 'Детектив', 1989, 'Росмэн', 'Это книга'),
('H7679424', 'Марина Степнова', 'Поэзия', 1952, 'Лабиринт', 'Это книга'),
('T5881592', 'Александр Пушкин', 'История', 1700, 'Махаон', 'Это книга'),
('L8206238', 'Федор Достоевский', 'Детектив', 1968, 'АСТ', 'Это книга'),
('J2925014', 'Марина Степнова', 'Мистика', 1808, 'Наука', 'Это книга'),
('R2222572', 'Виктор Астафьев', 'Фэнтези', 1893, 'Махаон', 'Это книга'),
('R2042203', 'Борис Акунин', 'Мистика', 1982, 'Росмэн', 'Это книга'),
('P5266267', 'Антон Чехов', 'Детектив', 1975, 'Питер', 'Это книга'),
('H1977678', 'Александр Куприн', 'Научная литература', 1974, 'Эксмо', 'Это книга'),
('V4326611', 'Лев Толстой', 'Роман', 1913, 'Альпина Паблишер', 'Это книга'),
('D5384645', 'Владимир Набоков', 'Фэнтези', 1947, 'Питер', 'Это книга'),
('T8177554', 'Иван Тургенев', 'Фантастика', 1889, 'Альпина Паблишер', 'Это книга'),
('F5896444', 'Алексей Толстой', 'Мистика', 1749, 'Наука', 'Это книга'),
('I8300558', 'Антон Чехов', 'Приключения', 1941, 'Наука', 'Это книга'),
('L3289967', 'Дмитрий Глуховский', 'Детектив', 1878, 'Махаон', 'Это книга'),
('B3480967', 'Алексей Толстой', 'Поэзия', 1854, 'Питер', 'Это книга'),
('Y2226555', 'Владимир Набоков', 'Фантастика', 1947, 'Лабиринт', 'Это книга'),
('G1618577', 'Дина Рубина', 'Драма', 1854, 'Росмэн', 'Это книга'),
('J2358402', 'Александр Куприн', 'Фантастика', 1922, 'Азбука', 'Это книга'),
('J0594633', 'Виктор Астафьев', 'История', 1759, 'Махаон', 'Это книга'),
('G8771088', 'Алексей Иванов', 'История', 1843, 'Наука', 'Это книга'),
('Z7821897', 'Виктор Пелевин', 'История', 1920, 'Питер', 'Это книга'),
('H8119600', 'Антон Чехов', 'Поэзия', 1734, 'Лабиринт', 'Это книга'),
('A4839949', 'Владимир Набоков', 'Приключения', 1832, 'Просвещение', 'Это книга'),
('F8316365', 'Дина Рубина', 'История', 1795, 'Питер', 'Это книга'),
('B2945833', 'Николай Гоголь', 'Мистика', 1876, 'Просвещение', 'Это книга'),
('H6722794', 'Александр Куприн', 'Роман', 1859, 'Наука', 'Это книга'),
('O2890946', 'Василий Шукшин', 'Фэнтези', 1852, 'Лабиринт', 'Это книга'),
('K4785564', 'Григорий Данилевский', 'История', 1816, 'Просвещение', 'Это книга'),
('D7553608', 'Евгений Замятин', 'Фэнтези', 1992, 'Просвещение', 'Это книга'),
('V8406198', 'Дмитрий Глуховский', 'Научная литература', 1805, 'Питер', 'Это книга'),
('L7122129', 'Дмитрий Глуховский', 'История', 1913, 'Питер', 'Это книга'),
('Y5807278', 'Евгений Замятин', 'Фэнтези', 1704, 'Просвещение', 'Это книга'),
('R1687102', 'Иван Тургенев', 'История', 1755, 'Альпина Паблишер', 'Это книга'),
('Z1693375', 'Аркадий Стругацкий', 'Фэнтези', 1770, 'Махаон', 'Это книга'),
('V9276167', 'Виктор Астафьев', 'История', 1984, 'Азбука', 'Это книга'),
('A3355549', 'Борис Стругацкий', 'Роман', 1753, 'Наука', 'Это книга'),
('P1106964', 'Иван Тургенев', 'Мистика', 1759, 'Просвещение', 'Это книга'),
('Q8663247', 'Валентин Распутин', 'Мистика', 1865, 'Альпина Паблишер', 'Это книга'),
('W4880934', 'Алексей Иванов', 'Роман', 1724, 'Росмэн', 'Это книга'),
('E7675990', 'Аркадий Стругацкий', 'Приключения', 1773, 'Питер', 'Это книга'),
('Y7642940', 'Виктор Астафьев', 'Драма', 1974, 'Просвещение', 'Это книга'),
('C3199447', 'Борис Стругацкий', 'Поэзия', 1709, 'Азбука', 'Это книга'),
('A7545698', 'Владимир Набоков', 'Детектив', 1964, 'Альпина Паблишер', 'Это книга'),
('S0602096', 'Марина Степнова', 'История', 1902, 'Эксмо', 'Это книга'),
('C5354573', 'Борис Акунин', 'Мистика', 1971, 'Лабиринт', 'Это книга'),
('Z1743404', 'Илья Ильф', 'История', 1751, 'Наука', 'Это книга'),
('C2594084', 'Борис Стругацкий', 'Роман', 1954, 'Азбука', 'Это книга'),
('F7320766', 'Лев Толстой', 'Драма', 1741, 'Лабиринт', 'Это книга'),
('O5673536', 'Чингиз Айтматов', 'История', 1723, 'Питер', 'Это книга'),
('K8462357', 'Виктор Пелевин', 'Поэзия', 1852, 'Просвещение', 'Это книга'),
('P1984334', 'Илья Ильф', 'Приключения', 1774, 'Махаон', 'Это книга'),
('U5561496', 'Аркадий Стругацкий', 'Научная литература', 1749, 'Лабиринт', 'Это книга'),
('K1967325', 'Василий Шукшин', 'Мистика', 1905, 'Наука', 'Это книга'),
('K9584603', 'Антон Чехов', 'Детектив', 1823, 'Росмэн', 'Это книга'),
('V0904630', 'Алексей Толстой', 'Фантастика', 1999, 'Лабиринт', 'Это книга'),
('Z1962563', 'Дина Рубина', 'Роман', 1780, 'Просвещение', 'Это книга'),
('Q3720361', 'Дина Рубина', 'Научная литература', 1872, 'Просвещение', 'Это книга'),
('F6329351', 'Михаил Булгаков', 'Фэнтези', 1849, 'Азбука', 'Это книга'),
('P3007800', 'Юрий Бондарев', 'Детектив', 1710, 'Махаон', 'Это книга'),
('C6290009', 'Василий Шукшин', 'Поэзия', 1804, 'Наука', 'Это книга'),
('P5286608', 'Илья Ильф', 'Фэнтези', 1839, 'Наука', 'Это книга'),
('I5291595', 'Федор Достоевский', 'Роман', 1728, 'Альпина Паблишер', 'Это книга'),
('B7841572', 'Александр Куприн', 'Поэзия', 1762, 'Просвещение', 'Это книга'),
('F5845044', 'Андрей Платонов', 'Драма', 1890, 'Росмэн', 'Это книга'),
('A7836535', 'Владимир Набоков', 'Научная литература', 1967, 'Альпина Паблишер', 'Это книга'),
('M2366521', 'Дмитрий Глуховский', 'Приключения', 1953, 'Росмэн', 'Это книга'),
('X2980972', 'Борис Стругацкий', 'Поэзия', 1915, 'Альпина Паблишер', 'Это книга'),
('V5909254', 'Чингиз Айтматов', 'Мистика', 1904, 'Азбука', 'Это книга'),
('J7826948', 'Александр Грин', 'Поэзия', 1723, 'Питер', 'Это книга'),
('E7699772', 'Дмитрий Глуховский', 'Фэнтези', 1947, 'Просвещение', 'Это книга'),
('A2400132', 'Алексей Толстой', 'Драма', 1823, 'Азбука', 'Это книга'),
('Q1267471', 'Дмитрий Глуховский', 'Роман', 1957, 'Лабиринт', 'Это книга'),
('B1371463', 'Василий Шукшин', 'Роман', 1948, 'Просвещение', 'Это книга'),
('Q8310736', 'Михаил Булгаков', 'Научная литература', 1857, 'АСТ', 'Это книга'),
('M6008215', 'Михаил Булгаков', 'Фэнтези', 1905, 'Наука', 'Это книга'),
('E5144175', 'Антон Чехов', 'Научная литература', 1871, 'Азбука', 'Это книга'),
('N9229100', 'Юрий Бондарев', 'Детектив', 1952, 'АСТ', 'Это книга'),
('W5132241', 'Дина Рубина', 'Детектив', 1718, 'АСТ', 'Это книга'),
('Z4668494', 'Андрей Платонов', 'История', 1750, 'Эксмо', 'Это книга'),
('P8556464', 'Константин Паустовский', 'Роман', 1713, 'Эксмо', 'Это книга'),
('I9538984', 'Дмитрий Глуховский', 'Приключения', 1767, 'Питер', 'Это книга'),
('U4614797', 'Антон Чехов', 'Фэнтези', 1873, 'Наука', 'Это книга'),
('D6554584', 'Сергей Лукьяненко', 'История', 1883, 'Наука', 'Это книга'),
('F9154007', 'Василий Шукшин', 'Поэзия', 1899, 'Лабиринт', 'Это книга'),
('Q9544203', 'Аркадий Стругацкий', 'Приключения', 1889, 'Азбука', 'Это книга'),
('D0092807', 'Лев Толстой', 'Фэнтези', 1729, 'Росмэн', 'Это книга'),
('R1733980', 'Илья Ильф', 'Фэнтези', 1909, 'Просвещение', 'Это книга');


delete from lending_books;
"""
WITH book_list AS (
    SELECT array_agg(cipher) AS ciphers FROM books
),
reader_list AS (
    SELECT array_agg(id) AS ids FROM readers
)
INSERT INTO lending_books (cipher, issue_date, return_date, reader_id)
SELECT
    bl.ciphers[(floor(random() * array_length(bl.ciphers,1)) + 1)::int] AS cipher,
    -- случайная дата выдачи за последние 1000 дней
    CURRENT_DATE - (floor(random() * 1000))::int AS issue_date,
    -- return_date >= issue_date, 30% книг ещё не возвращены
    CASE
        WHEN random() < 0.7 THEN 
            CURRENT_DATE - (floor(random() * 1000))::int + (floor(random() * 100))::int
        ELSE NULL
    END AS return_date,
    rl.ids[(floor(random() * array_length(rl.ids,1)) + 1)::int] AS reader_id
FROM generate_series(1,300) AS s(i),
     book_list bl,
     reader_list rl;
"""

WITH book_list AS (
    SELECT array_agg(cipher) AS ciphers FROM books
),
reader_list AS (
    SELECT array_agg(id) AS ids FROM readers
)
INSERT INTO lending_books (cipher, issue_date, return_date, reader_id)
SELECT
    bl.ciphers[(floor(random() * array_length(bl.ciphers,1)) + 1)::int] AS cipher,
    issue_date,
    CASE
        WHEN random() < 0.7 THEN issue_date + (floor(random() * 100))::int
        ELSE NULL
    END AS return_date,
    rl.ids[(floor(random() * array_length(rl.ids,1)) + 1)::int] AS reader_id
FROM (
    SELECT CURRENT_DATE - (floor(random() * 1000))::int AS issue_date
    FROM generate_series(1,300)
) AS gen_dates,
     book_list bl,
     reader_list rl;